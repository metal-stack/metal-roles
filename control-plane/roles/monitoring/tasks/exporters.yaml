---
- name: Deploy metal-metrics-exporter
  k8s:
    definition: "{{ lookup('template', 'metrics-exporters/metal-metrics-exporter.yaml') }}"
    namespace: "{{ monitoring_namespace }}"
    apply: true

- name: Deploy rethinkdb-exporter
  k8s:
    definition: "{{ lookup('template', 'metrics-exporters/rethinkdb-exporter.yaml') }}"
    namespace: "{{ monitoring_namespace }}"
    apply: true

- name: Deploy event-exporter
  k8s:
    definition: "{{ lookup('template', 'metrics-exporters/event-exporter.yaml') }}"
    namespace: "{{ monitoring_namespace }}"
    apply: true

- name: Deploy alertmanager
  k8s:
    definition: "{{ lookup('template', 'alertmanager/' + item) }}"
    namespace: "{{ monitoring_namespace }}"
  loop:
    - alertmanager.secter.yaml
    - alertmanager.service.yaml
    - alertmanager.serviceaccount.yaml
    - alertmanager.servicemonitor.yaml
    - alertmanager.yaml
