---
config:
  clients:
    - url: https://{{ monitoring_thanos_receive_ingress_dns }}/loki/api/v1/push
      basic_auth:
        username: promtail
        password: {{ monitoring_thanos_receive_ingress_basic_auth }}

  snippets:
    pipelineStages:
      - cri: {}
      - docker: {}
      - match:
          selector: '{app="eventrouter"}'
          stages:
          - json:
              expressions:
                event: event
          - json:
              expressions:
                metadata: metadata
              source: event
          - json:
              expressions:
                namespace: namespace
              source: metadata
          - labels:
              namespace: null
          - output:
              source: event

extraArgs:
  - -client.external-labels=cluster={{ item }}
